<!DOCTYPE html>
<html lang="ca">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Greta App - Frases Tema 3</title>
<style>
body{margin:0;font-family:sans-serif;background:#f9fafb;color:#0f172a}
header{padding:12px;background:#fff;border-bottom:1px solid #e5e7eb;display:flex;justify-content:center}
.mode-btns button{margin:0 6px;padding:8px 14px;border:none;border-radius:14px;font-weight:700;cursor:pointer}
.mode-en{background:#dbeafe}
.mode-es{background:#fde68a}
main{display:flex;justify-content:center;padding:24px}
.card{position:relative;width:100%;max-width:560px;background:#fff;border-radius:28px;padding:32px;box-shadow:0 12px 30px rgba(0,0,0,0.08);text-align:center}
.counter{position:absolute;top:18px;right:22px;font-weight:800;color:#2563eb}
.lang{font-size:14px;font-weight:800;letter-spacing:1px;color:#64748b;margin-bottom:6px}
.audio-btn{width:120px;height:120px;border-radius:50%;border:none;background:#dbeafe;font-size:36px;cursor:pointer;margin:6px auto 10px;display:flex;align-items:center;justify-content:center}
.hidden{display:none}
.target{font-size:16px;font-weight:900;color:#9333ea;margin-top:10px}
.es{font-size:20px;color:#2563eb;margin-top:14px}
.en{font-size:20px;color:#0f172a;margin-top:14px;font-weight:700}
.buttons{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px;margin-top:22px}
button.action{padding:16px 0;border:none;border-radius:16px;font-weight:800;cursor:pointer}
.reveal{background:#e0f2fe}
.know{background:#dcfce7}
.next{background:#fbcfe8}
.list-btn{margin-top:16px;background:#e9d5ff;border:none;border-radius:16px;padding:14px;font-weight:800;cursor:pointer;width:100%}
.list-box{max-width:560px;margin:16px auto;background:#fff;border-radius:20px;border:1px solid #e5e7eb;padding:16px;text-align:left}
.list-item{padding:10px 0;border-bottom:1px solid #e5e7eb}
.list-item:last-child{border-bottom:none}
.list-es{color:#2563eb;font-weight:700}
.list-en{color:#0f172a;font-weight:800}
.end{margin-top:16px;font-weight:800;color:#16a34a}
</style>
</head>
<body>
<header>
 <div class="mode-btns">
  <button class="mode-en" onclick="setMode('EN')">ANGLÃˆS â†’ CASTELLÃ€</button>
  <button class="mode-es" onclick="setMode('ES')">CASTELLÃ€ â†’ ANGLÃˆS</button>
 </div>
</header>
<main>
<div class="card">
 <div class="counter" id="counter">0 / 7</div>
 <div id="langLabel" class="lang">ANGLÃˆS</div>
 <button class="audio-btn" onclick="play()">ðŸ”Š</button>
 <div id="target" class="target hidden"></div>
 <div id="es" class="es hidden"></div>
 <div id="en" class="en hidden"></div>
 <div class="buttons">
  <button class="action reveal" onclick="reveal()">Veure</button>
  <button class="action know" onclick="know()">Ja la sÃ©</button>
  <button class="action next" onclick="nextOne()">SegÃ¼ent</button>
 </div>
 <button class="list-btn" onclick="toggleList()">Veure tota la llista</button>
 <div id="endMsg" class="end hidden">âœ” Ja les saps totes</div>
</div>
</main>
<div id="listBox" class="list-box hidden"></div>

<script>
const items = [
    {"audio": "f001.mp3", "target": "Whereas", "en": "My brother always eats a lot of junk food like burgers and pizza for dinner, whereas I prefer to eat a healthy salad with tomatoes and chicken because I want to be fit.", "es": "Mi hermano siempre cena mucha comida basura como hamburguesas y pizza, mientras que yo prefiero comer una ensalada saludable con tomates y pollo porque quiero estar en forma."},
    {"audio": "f002.mp3", "target": "Therefore", "en": "Yesterday I woke up very late and I didn't have time to eat breakfast at home; so, I was very hungry during my English class and I couldn't concentrate well.", "es": "Ayer me desperte muy tarde y no tuve tiempo de desayunar en casa; por lo tanto, tuve mucha hambre durante mi clase de ingles y no pude concentrarme bien."},
    {"audio": "f003.mp3", "target": "Broad", "en": "The new road near the park is very broad and beautiful, so many people go there every weekend to walk with their dogs or to ride their bicycles with their friends.", "es": "La carretera nueva cerca del parque es muy ancha y bonita, asi que mucha gente va alli cada fin de semana para caminar con sus perros o para montar en sus bicicletas con sus amigos."},
    {"audio": "f004.mp3", "target": "Roughly", "en": "I think there were roughly eighty students in the museum yesterday, and they were all wearing red jackets and carrying big backpacks with their lunch and water.", "es": "Creo que habia aproximadamente ochenta estudiantes en el museo ayer, y todos llevaban chaquetas rojas y cargaban mochilas grandes con su almuerzo y agua."},
    {"audio": "f005.mp3", "target": "Rough", "en": "We wanted to go to the beach to swim in the ocean, but the water was very rough and the wind was cold, so we decided to stay at the hotel and play games.", "es": "Queriamos ir a la playa para nadar en el oceano, pero el agua estaba muy agitada y el viento estaba frio, asi que decidimos quedarnos en el hotel y jugar a juegos."},
    {"audio": "f006.mp3", "target": "Take up", "en": "My best friend wants to take up a new hobby like photography or painting next summer because she has a lot of free time and she wants to learn something creative.", "es": "Mi mejor amiga quiere empezar un nuevo hobby como la fotografia o la pintura el proximo verano porque tiene mucho tiempo libre y quiere aprender algo creativo."},
    {"audio": "f007.mp3", "target": "Warn", "en": "I need to warn you that the movie is very long and a bit boring, so you should bring some snacks and a drink if you want to go to the cinema tonight.", "es": "Necesito advertirte que la pelicula es muy larga y un poco aburrida, asi que deberias traer algunos aperitivos y una bebida si quieres ir al cine esta noche."}
];

let remaining=[...items], current=null, mode="EN", known=0;
let audioPlayer = new Audio();

function updateCounter(){ document.getElementById("counter").textContent = known + " / " + items.length; }

function play(){ 
    if(current) {
        audioPlayer.src = current.audio;
        audioPlayer.play().catch(e => console.log("Error audio"));
    }
}

function load(){
 if(remaining.length===0){
   document.getElementById("endMsg").classList.remove("hidden");
   return;
 }
 current=remaining[Math.floor(Math.random()*remaining.length)];
 document.getElementById("target").classList.add("hidden");
 document.getElementById("es").classList.add("hidden");
 document.getElementById("en").classList.add("hidden");
 
 if(mode==="EN"){
  document.getElementById("langLabel").textContent="INGLES";
  play();
 } else {
  document.getElementById("langLabel").textContent="CASTELLANO";
  document.getElementById("es").textContent=current.es;
  document.getElementById("es").classList.remove("hidden");
 }
}

function reveal(){
 if(!current)return;
 document.getElementById("target").textContent="Expresion clave: " + current.target;
 document.getElementById("target").classList.remove("hidden");
 document.getElementById("es").textContent=current.es;
 document.getElementById("en").textContent=current.en;
 document.getElementById("es").classList.remove("hidden");
 document.getElementById("en").classList.remove("hidden");
 if(mode==="ES") play();
}

function know(){
 if(!current||remaining.length===0)return;
 remaining=remaining.filter(i=>i!==current);
 known++;
 updateCounter();
 load();
}

function nextOne(){ load(); }
function setMode(m){ mode=m; load(); }

function toggleList(){
 const lb = document.getElementById("listBox");
 lb.innerHTML="";
 items.forEach(i=>{
  const d=document.createElement("div");
  d.className="list-item";
  d.innerHTML="<div class='list-es'>"+i.es+"</div><div class='list-en'>"+i.en+"</div>";
  lb.appendChild(d);
 });
 lb.classList.toggle("hidden");
}

updateCounter();
load();
 // --- CÃ“DIGO INTELIGENTE PARA EL CUADRITO DE MARCADO ---

const style = document.createElement('style');
style.innerHTML = `
    .check-box-manual {
        position: absolute;
        top: 85px; 
        right: 22px;
        width: 24px;
        height: 24px;
        background: #fff !important;
        border: 1.5px solid #22c55e !important;
        border-radius: 6px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        z-index: 10;
        transition: all 0.2s;
        font-size: 14px;
    }
    .check-box-manual.marked { 
        background: #22c55e !important; 
        color: white; 
    }
`;
document.head.appendChild(style);

function getFolderName() {
    const path = window.location.pathname;
    return path.split('/').filter(Boolean).slice(-2, -1)[0] || "unknown";
}

function markAsDone(element) {
    localStorage.setItem(getFolderName(), new Date().toISOString());
    element.innerHTML = "âœ“";
    element.classList.add('marked');
    alert("LliÃ§Ã³ marcada âœ…");
}

// 1. Crear el cuadrito
const card = document.querySelector(".card");
const box = document.createElement("div");
box.className = "check-box-manual";

// 2. Comprobar si ya estaba marcada antes de pintarla
if (localStorage.getItem(getFolderName())) {
    box.innerHTML = "âœ“";
    box.classList.add('marked');
}

box.onclick = function() { markAsDone(this); };
card.appendChild(box);
</script>
</body>
</html>